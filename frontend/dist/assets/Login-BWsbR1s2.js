import{w as T,j as e,S as $,a as S,L as z}from"./index-gm4XY7Dh.js";import{r as o,d as B,u as X,L as u}from"./vendor-CvUQ7FSA.js";import{C as _,b as H,c as U,a as G}from"./Card-ct0JxCCf.js";import{C as J}from"./checkbox-T3_sBEbb.js";import{I as V}from"./Input-BoijLIkg.js";import{L as g}from"./label-B3NocW4B.js";import{A as E,a as L}from"./alert-dbwOQxjT.js";import{C as A}from"./circle-alert-B-efKsjX.js";import{R as K}from"./refresh-cw-dQTnxzmC.js";import{M as k}from"./mail-Bm_S11fa.js";import{L as Q}from"./lock-DiOu4SZ2.js";import{E as W}from"./eye-off-C98bhrRg.js";import{E as Y}from"./eye-2sExp-ov.js";import{A as Z}from"./arrow-right-BwqWpyzD.js";import"./firebase-De9GV7Vy.js";import"./index-TMJn6bF9.js";import"./check-Cx9i6ejF.js";const ge=()=>{var C;const[l,R]=o.useState({email:"",password:""}),[x,v]=o.useState(!1),[j,D]=o.useState(!1),[h,F]=o.useState(!1),[n,r]=o.useState({}),[t,m]=o.useState(null),[f,N]=o.useState(!1),{login:I,isAuthenticated:b,resendEmailVerification:M}=T(),p=B(),d=X();o.useEffect(()=>{var s,i;if(b){const c=((i=(s=d.state)==null?void 0:s.from)==null?void 0:i.pathname)||"/dashboard";p(c,{replace:!0})}},[b,p,d]);const y=(C=d.state)==null?void 0:C.message,q=()=>{const s={};return l.email?/\S+@\S+\.\S+/.test(l.email)||(s.email="Veuillez entrer une adresse email valide"):s.email="L'email est requis",l.password?l.password.length<6&&(s.password="Le mot de passe doit contenir au moins 6 caractères"):s.password="Le mot de passe est requis",r(s),Object.keys(s).length===0},O=async s=>{var i,c;if(s.preventDefault(),!!q()){v(!0),r({}),m(null);try{await I(l.email,l.password,j);const a=((c=(i=d.state)==null?void 0:i.from)==null?void 0:c.pathname)||"/dashboard";p(a,{replace:!0})}catch(a){a.message==="EMAIL_NOT_VERIFIED"||a.message.includes("Email non vérifié")?(m({email:l.email,canResend:!0,lastVerificationSent:void 0}),r({general:"Votre email n'est pas encore vérifié. Vérifiez votre boîte mail ou demandez un nouveau lien de vérification."})):a.message.includes("Invalid credentials")||a.message.includes("Identifiants invalides")?r({general:"Email ou mot de passe invalide. Veuillez réessayer."}):a.message.includes("Account locked")||a.message.includes("Compte verrouillé")?r({general:"Votre compte a été temporairement verrouillé. Veuillez réessayer plus tard."}):a.message.includes("Account suspended")||a.message.includes("Compte suspendu")?r({general:"Votre compte a été suspendu. Contactez le support pour plus d'informations."}):r({general:a.message||"Échec de la connexion. Veuillez réessayer."})}finally{v(!1)}}},w=s=>{const{name:i,value:c}=s.target;R(a=>({...a,[i]:c})),n[i]&&r(a=>({...a,[i]:""})),i==="email"&&t&&m(null)},P=async()=>{if(t!=null&&t.email){N(!0);try{await M(t.email),r({general:"Un nouveau lien de vérification a été envoyé à votre adresse email. Vérifiez votre boîte mail."}),m(s=>s?{...s,lastVerificationSent:new Date().toISOString()}:null)}catch(s){s.message.includes("rate limit")||s.message.includes("limite")?r({general:"Trop de demandes de vérification. Veuillez patienter avant de réessayer."}):r({general:s.message||"Échec de l'envoi de l'email de vérification. Veuillez réessayer."})}finally{N(!1)}}};return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4 sm:p-6 lg:p-8",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"w-12 h-12 bg-gray-900 rounded-lg flex items-center justify-center",children:e.jsx($,{className:"text-white w-6 h-6"})})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Bon retour"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Connectez-vous à votre compte AttendanceX"})]}),y&&e.jsxs(E,{className:"mb-6",children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx(L,{children:y})]}),e.jsxs(_,{className:"bg-white border-gray-200 shadow-sm",children:[e.jsx(H,{className:"space-y-1 pb-6",children:e.jsx(U,{className:"text-xl text-center text-gray-900",children:"Connexion"})}),e.jsxs(G,{className:"space-y-4",children:[n.general&&e.jsxs(E,{className:`mb-4 ${t?"border-orange-200 bg-orange-50":""}`,variant:t?"default":"destructive",children:[e.jsx(A,{className:`h-4 w-4 ${t?"text-orange-600":""}`}),e.jsxs(L,{className:t?"text-orange-800":"",children:[n.general,t&&t.canResend&&e.jsxs("div",{className:"mt-3 flex flex-col sm:flex-row gap-2",children:[e.jsx(S,{type:"button",onClick:P,disabled:f,variant:"outline",size:"sm",className:"border-orange-300 text-orange-700 hover:bg-orange-100 hover:border-orange-400",children:f?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-4 h-4 mr-2 animate-spin"}),"Envoi en cours..."]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Renvoyer l'email de vérification"]})}),t.lastVerificationSent&&e.jsxs("span",{className:"text-sm text-orange-600 self-center",children:["Dernier envoi: ",new Date(t.lastVerificationSent).toLocaleTimeString()]})]})]})]}),e.jsxs("form",{onSubmit:O,className:"space-y-5",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"email",className:"text-sm font-medium text-gray-700 mb-2 block",children:"Adresse email"}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 pointer-events-none z-10"}),e.jsx(V,{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:l.email,onChange:w,className:`pl-10 w-full ${n.email?"border-red-300 focus:border-red-500 focus:ring-red-500":""}`,placeholder:"Entrez votre email"})]}),n.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.email})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"password",className:"text-sm font-medium text-gray-700 mb-2 block",children:"Mot de passe"}),e.jsxs("div",{className:"relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 pointer-events-none z-10"}),e.jsx(V,{id:"password",name:"password",type:h?"text":"password",autoComplete:"current-password",required:!0,value:l.password,onChange:w,className:`pl-10 pr-10 w-full ${n.password?"border-red-300 focus:border-red-500 focus:ring-red-500":""}`,placeholder:"Entrez votre mot de passe"}),e.jsx("button",{type:"button",onClick:()=>F(!h),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 z-10",children:h?e.jsx(W,{className:"w-4 h-4"}):e.jsx(Y,{className:"w-4 h-4"})})]}),n.password&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.password})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(J,{id:"remember-me",checked:j,onCheckedChange:D}),e.jsx(g,{htmlFor:"remember-me",className:"text-sm text-gray-600 cursor-pointer",children:"Se souvenir de moi"})]}),e.jsx(u,{to:"/forgot-password",className:"text-sm text-gray-700 hover:text-gray-900 hover:underline font-medium",children:"Mot de passe oublié ?"})]}),e.jsxs(S,{type:"submit",disabled:x||f,className:"w-full bg-gray-900 text-white hover:bg-gray-800 font-medium h-12",children:[x?e.jsx(z,{className:"w-4 h-4 animate-spin mr-2"}):e.jsx(Z,{className:"w-4 h-4 mr-2"}),x?"Connexion en cours...":"Se connecter"]}),t&&e.jsx("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(k,{className:"w-5 h-5 text-blue-600 mt-0.5 mr-3 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"Vérification d'email requise"}),e.jsx("p",{className:"mb-2",children:"Pour des raisons de sécurité, vous devez vérifier votre adresse email avant de pouvoir vous connecter."}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-blue-700",children:[e.jsx("li",{children:"Vérifiez votre boîte mail (y compris les spams)"}),e.jsx("li",{children:"Cliquez sur le lien de vérification dans l'email"}),e.jsx("li",{children:"Revenez ici pour vous connecter"})]})]})]})})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-200"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Nouveau sur AttendanceX ?"})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx(u,{to:"/register",className:"text-gray-700 hover:text-gray-900 font-medium hover:underline",children:"Créer un compte"})})]})]})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("p",{className:"text-sm text-gray-500",children:["En vous connectant, vous acceptez nos"," ",e.jsx(u,{to:"/terms",className:"text-gray-700 hover:text-gray-900 hover:underline",children:"Conditions d'utilisation"})," ","et notre"," ",e.jsx(u,{to:"/privacy",className:"text-gray-700 hover:text-gray-900 hover:underline",children:"Politique de confidentialité"})]})})]})})};export{ge as default};
//# sourceMappingURL=Login-BWsbR1s2.js.map
