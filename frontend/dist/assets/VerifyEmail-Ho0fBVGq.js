import{w as T,j as e,L as h,a as m,S as k}from"./index-gm4XY7Dh.js";import{g as _,d as O,r as n,L as v}from"./vendor-CvUQ7FSA.js";import{C as D,b as F,c as U,a as q}from"./Card-ct0JxCCf.js";import{A as M,a as B}from"./alert-dbwOQxjT.js";import{C as l}from"./circle-check-big-eEft8Q46.js";import{C as u}from"./clock-Tx-U9-MC.js";import{C as g}from"./circle-x-B_KOwtkV.js";import{C as p}from"./circle-alert-B-efKsjX.js";import{A as b}from"./arrow-right-BwqWpyzD.js";import{R as K}from"./refresh-cw-dQTnxzmC.js";import{M as w}from"./mail-Bm_S11fa.js";import"./firebase-De9GV7Vy.js";const re=()=>{const[C]=_(),f=O(),{verifyEmail:j,resendEmailVerification:V}=T(),[s,i]=n.useState("loading"),[E,a]=n.useState(""),[c,I]=n.useState(""),[d,N]=n.useState(!1),[o,A]=n.useState(5),x=C.get("token");n.useEffect(()=>{(async()=>{if(!x){i("invalid"),a("Aucun token de vérification fourni. Veuillez vérifier le lien dans votre email.");return}try{i("loading"),a("Vérification de votre adresse email en cours..."),await j(x),i("success"),a("Votre adresse email a été vérifiée avec succès ! Vous pouvez maintenant vous connecter.");const r=setInterval(()=>{A(y=>y<=1?(clearInterval(r),f("/login",{replace:!0,state:{message:"Email vérifié ! Vous pouvez maintenant vous connecter.",type:"success"}}),0):y-1)},1e3);return()=>clearInterval(r)}catch(r){console.error("Email verification error:",r),r.message.includes("VERIFICATION_TOKEN_EXPIRED")||r.message.includes("expired")?(i("expired"),a("Ce lien de vérification a expiré. Les liens de vérification sont valides pendant 24 heures pour des raisons de sécurité.")):r.message.includes("VERIFICATION_TOKEN_USED")||r.message.includes("used")?(i("used"),a("Ce lien de vérification a déjà été utilisé. Votre email est peut-être déjà vérifié.")):r.message.includes("INVALID_VERIFICATION_TOKEN")||r.message.includes("invalid")?(i("invalid"),a("Ce lien de vérification est invalide. Veuillez vérifier le lien dans votre email ou demander un nouveau lien.")):r.message.includes("EMAIL_NOT_VERIFIED")?(i("error"),a("Erreur lors de la vérification. Veuillez réessayer ou demander un nouveau lien de vérification.")):(i("error"),a(r.message||"Une erreur inattendue s'est produite lors de la vérification. Veuillez réessayer."))}})()},[x,j,f]);const L=async()=>{if(c.trim())try{N(!0),await V(c),a("Un nouveau lien de vérification a été envoyé à votre adresse email.")}catch(t){console.error("Resend verification error:",t),(t.message.includes("rate limit")||t.message.includes("too many"))&&a("Trop de tentatives. Veuillez attendre avant de demander un nouveau lien.")}finally{N(!1)}},R=()=>{switch(s){case"loading":return e.jsx(h,{className:"w-8 h-8 animate-spin text-blue-600"});case"success":return e.jsx(l,{className:"w-8 h-8 text-green-600"});case"expired":return e.jsx(u,{className:"w-8 h-8 text-orange-600"});case"used":return e.jsx(l,{className:"w-8 h-8 text-gray-600"});case"invalid":return e.jsx(g,{className:"w-8 h-8 text-red-600"});case"error":return e.jsx(p,{className:"w-8 h-8 text-red-600"});default:return e.jsx(w,{className:"w-8 h-8 text-gray-600"})}},z=()=>{switch(s){case"loading":return"border-blue-200 bg-blue-50";case"success":return"border-green-200 bg-green-50";case"expired":return"border-orange-200 bg-orange-50";case"used":return"border-gray-200 bg-gray-50";case"invalid":case"error":return"border-red-200 bg-red-50";default:return"border-gray-200 bg-gray-50"}},S=()=>{switch(s){case"loading":return"Vérification en cours...";case"success":return"Email vérifié !";case"expired":return"Lien expiré";case"used":return"Lien déjà utilisé";case"invalid":return"Lien invalide";case"error":return"Erreur de vérification";default:return"Vérification d'email"}};return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"w-16 h-16 bg-white rounded-lg flex items-center justify-center shadow-sm border",children:R()})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:S()}),e.jsxs("p",{className:"text-gray-600 mt-2",children:[s==="loading"&&"Veuillez patienter pendant que nous vérifions votre adresse email",s==="success"&&`Redirection vers la connexion dans ${o} seconde${o>1?"s":""}`,s==="expired"&&"Le lien de vérification a expiré",s==="used"&&"Ce lien a déjà été utilisé",s==="invalid"&&"Le lien de vérification est invalide",s==="error"&&"Une erreur s'est produite lors de la vérification"]})]}),e.jsxs(D,{className:"bg-white border-gray-200 shadow-sm",children:[e.jsx(F,{className:"space-y-1 pb-6",children:e.jsx(U,{className:"text-xl text-center text-gray-900",children:"Vérification d'email"})}),e.jsxs(q,{className:"space-y-6",children:[e.jsxs(M,{className:z(),children:[s==="success"?e.jsx(l,{className:"h-4 w-4 text-green-600"}):s==="loading"?e.jsx(h,{className:"h-4 w-4 animate-spin text-blue-600"}):s==="expired"?e.jsx(u,{className:"h-4 w-4 text-orange-600"}):s==="used"?e.jsx(l,{className:"h-4 w-4 text-gray-600"}):s==="invalid"?e.jsx(g,{className:"h-4 w-4 text-red-600"}):e.jsx(p,{className:"h-4 w-4 text-red-600"}),e.jsx(B,{className:"text-gray-700",children:E})]}),s==="success"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(l,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-900",children:"Compte activé"}),e.jsx("p",{className:"text-sm text-green-700",children:"Vous pouvez maintenant vous connecter à votre compte"})]})]})}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(u,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Redirection automatique"}),e.jsxs("p",{className:"text-sm text-blue-700",children:["Vous serez redirigé vers la page de connexion dans ",o," seconde",o>1?"s":""]})]})]})}),e.jsx(m,{asChild:!0,className:"w-full bg-gray-900 text-white hover:bg-gray-800",children:e.jsxs(v,{to:"/login",children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Aller à la connexion maintenant"]})})]}),(s==="error"||s==="expired"||s==="invalid"||s==="used")&&e.jsxs("div",{className:"space-y-4",children:[s==="expired"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"bg-orange-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(u,{className:"w-5 h-5 text-orange-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-orange-900",children:"Lien expiré"}),e.jsx("p",{className:"text-sm text-orange-700",children:"Les liens de vérification expirent après 24 heures pour des raisons de sécurité."})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Adresse email"}),e.jsx("input",{id:"email",type:"email",placeholder:"Entrez votre adresse email",value:c,onChange:t=>I(t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent",disabled:d}),e.jsxs(m,{onClick:L,disabled:d||!c.trim(),variant:"outline",className:"w-full",children:[d?e.jsx(K,{className:"w-4 h-4 animate-spin mr-2"}):e.jsx(w,{className:"w-4 h-4 mr-2"}),d?"Envoi en cours...":"Envoyer un nouveau lien de vérification"]})]})]}),s==="used"&&e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(l,{className:"w-5 h-5 text-gray-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Lien déjà utilisé"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Ce lien de vérification a déjà été utilisé. Votre email est peut-être déjà vérifié."})]})]})}),s==="invalid"&&e.jsx("div",{className:"bg-red-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(g,{className:"w-5 h-5 text-red-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-900",children:"Lien invalide"}),e.jsx("p",{className:"text-sm text-red-700",children:"Ce lien de vérification est invalide. Veuillez vérifier le lien dans votre email."})]})]})}),s==="error"&&e.jsx("div",{className:"bg-red-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(p,{className:"w-5 h-5 text-red-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-900",children:"Erreur de vérification"}),e.jsx("p",{className:"text-sm text-red-700",children:"Une erreur s'est produite lors de la vérification. Veuillez réessayer."})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{asChild:!0,className:"w-full bg-gray-900 text-white hover:bg-gray-800",children:e.jsxs(v,{to:"/login",children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Essayer de se connecter"]})}),e.jsx(m,{asChild:!0,variant:"outline",className:"w-full",children:e.jsx(v,{to:"/register",children:"Retour à l'inscription"})})]})]}),s==="loading"&&e.jsx("div",{className:"text-center py-8",children:e.jsxs("div",{className:"bg-blue-50 rounded-lg p-6",children:[e.jsx(h,{className:"w-8 h-8 animate-spin text-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-sm font-medium text-blue-900 mb-2",children:"Vérification en cours..."}),e.jsx("p",{className:"text-sm text-blue-700",children:"Cela peut prendre quelques instants. Veuillez ne pas fermer cette page."})]})})]})]}),e.jsxs("div",{className:"mt-6 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2 text-sm text-gray-500",children:[e.jsx(k,{className:"w-4 h-4"}),e.jsx("span",{children:"Vérification sécurisée par AttendanceX"})]}),e.jsx("div",{className:"mt-4 text-xs text-gray-400",children:e.jsx("p",{children:"Besoin d'aide ? Contactez-nous à support@attendance-x.com"})})]})]})})};export{re as default};
//# sourceMappingURL=VerifyEmail-Ho0fBVGq.js.map
