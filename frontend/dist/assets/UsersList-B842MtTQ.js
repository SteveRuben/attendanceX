import{w as T,z as _,y as h,j as e,a as n,E as S,o as G,G as O,H as q,I as H,D as X,U as o,S as y,B as w}from"./index-gm4XY7Dh.js";import{d as J,r as d,L as A}from"./vendor-CvUQ7FSA.js";import{C as p,a as j}from"./Card-ct0JxCCf.js";import{I as K}from"./Input-BoijLIkg.js";import{S as U,a as P,b as I,c as z,d as l}from"./select-byvKiojp.js";import{u as k}from"./userService-LLdjq6tZ.js";import{M as Q}from"./mail-Bm_S11fa.js";import{P as W}from"./phone-CXGJeqaQ.js";import{B as Y}from"./building-C4sNiXDP.js";import{U as Z}from"./user-x-B0h_aedd.js";import{U as E}from"./user-check-C2Vgj06z.js";import{S as ee}from"./square-pen-Gln_tB11.js";import"./firebase-De9GV7Vy.js";import"./index-TMJn6bF9.js";import"./chevron-down-L5bpcUyJ.js";import"./check-Cx9i6ejF.js";const fe=()=>{const{user:m}=T(),{canManageUsers:u}=_(),f=J(),[x,$]=d.useState([]),[B,g]=d.useState(!0),[t,v]=d.useState({search:"",role:"all",status:"all",department:""}),[i,c]=d.useState({page:1,limit:20,total:0,totalPages:0});d.useEffect(()=>{N()},[t,i.page]);const N=async()=>{try{g(!0);const s={page:i.page,limit:i.limit};t.search&&(s.search=t.search),t.role!=="all"&&(s.role=t.role),t.status!=="all"&&(s.status=t.status),t.department&&(s.department=t.department);const a=await k.getUsers(s);a.success&&a.data&&($(a.data.data),c(r=>({...r,total:a.data.pagination.total,totalPages:a.data.pagination.totalPages})))}catch(s){console.error("Error loading users:",s),h.error("Erreur lors du chargement des utilisateurs")}finally{g(!1)}},M=s=>{v(a=>({...a,search:s})),c(a=>({...a,page:1}))},b=(s,a)=>{v(r=>({...r,[s]:a})),c(r=>({...r,page:1}))},D=s=>{const r={super_admin:{variant:"destructive",label:"Super Admin",icon:y},admin:{variant:"destructive",label:"Admin",icon:y},organizer:{variant:"default",label:"Organisateur",icon:o},moderator:{variant:"secondary",label:"Modérateur",icon:E},analyst:{variant:"outline",label:"Analyste",icon:o},participant:{variant:"outline",label:"Participant",icon:o}}[s]||{variant:"outline",label:s,icon:o},V=r.icon;return e.jsxs(w,{variant:r.variant,className:"flex items-center gap-1",children:[e.jsx(V,{className:"w-3 h-3"}),r.label]})},F=s=>{const r={active:{variant:"default",label:"Actif"},inactive:{variant:"secondary",label:"Inactif"},pending:{variant:"outline",label:"En attente"},suspended:{variant:"destructive",label:"Suspendu"}}[s]||{variant:"outline",label:s};return e.jsx(w,{variant:r.variant,children:r.label})},L=s=>{if(s.firstName&&s.lastName)return`${s.firstName[0]}${s.lastName[0]}`.toUpperCase();if(s.displayName){const a=s.displayName.split(" ");return a.length>1?`${a[0][0]}${a[1][0]}`.toUpperCase():a[0][0].toUpperCase()}return s.email[0].toUpperCase()},C=async(s,a)=>{try{(await k.changeUserStatus(s,a)).success&&(h.success("Statut utilisateur mis à jour"),N())}catch{h.error("Erreur lors de la mise à jour du statut")}},R=s=>new Date(s).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"});return B&&x.length===0?e.jsx("div",{className:"container-fluid py-6",children:e.jsxs("div",{className:"animate-pulse space-y-6",children:[e.jsx("div",{className:"h-8 bg-muted rounded w-1/3"}),e.jsx("div",{className:"grid gap-4",children:[...Array(5)].map((s,a)=>e.jsx("div",{className:"h-24 bg-muted rounded"},a))})]})}):e.jsxs("div",{className:"container-fluid py-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Utilisateurs"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Gérez les utilisateurs et leurs permissions"})]}),u&&e.jsxs(n,{onClick:()=>f("/users/create"),children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Nouvel utilisateur"]})]}),e.jsx(p,{children:e.jsx(j,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(G,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(K,{placeholder:"Rechercher des utilisateurs...",value:t.search,onChange:s=>M(s.target.value),className:"pl-10"})]})}),e.jsxs(U,{value:t.role,onValueChange:s=>b("role",s),children:[e.jsx(P,{className:"w-[180px]",children:e.jsx(I,{placeholder:"Rôle"})}),e.jsxs(z,{children:[e.jsx(l,{value:"all",children:"Tous les rôles"}),e.jsx(l,{value:"super_admin",children:"Super Admin"}),e.jsx(l,{value:"admin",children:"Admin"}),e.jsx(l,{value:"organizer",children:"Organisateur"}),e.jsx(l,{value:"moderator",children:"Modérateur"}),e.jsx(l,{value:"analyst",children:"Analyste"}),e.jsx(l,{value:"participant",children:"Participant"})]})]}),e.jsxs(U,{value:t.status,onValueChange:s=>b("status",s),children:[e.jsx(P,{className:"w-[180px]",children:e.jsx(I,{placeholder:"Statut"})}),e.jsxs(z,{children:[e.jsx(l,{value:"all",children:"Tous les statuts"}),e.jsx(l,{value:"active",children:"Actif"}),e.jsx(l,{value:"inactive",children:"Inactif"}),e.jsx(l,{value:"pending",children:"En attente"}),e.jsx(l,{value:"suspended",children:"Suspendu"})]})]})]})})}),e.jsx("div",{className:"space-y-4",children:x.length>0?x.map(s=>e.jsx(p,{className:"card-interactive",children:e.jsx(j,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(O,{className:"w-12 h-12",children:[e.jsx(q,{src:s.profilePicture}),e.jsx(H,{children:L(s)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:s.displayName||`${s.firstName} ${s.lastName}`}),D(s.role),F(s.status)]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Q,{className:"w-4 h-4 mr-1"}),s.email]}),s.phone&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(W,{className:"w-4 h-4 mr-1"}),s.phone]}),s.department&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(Y,{className:"w-4 h-4 mr-1"}),s.department]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(X,{className:"w-4 h-4 mr-1"}),"Inscrit le ",R(s.createdAt)]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(n,{variant:"outline",size:"sm",asChild:!0,children:e.jsx(A,{to:`/users/${s.id}`,children:"Voir profil"})}),u&&s.id!==(m==null?void 0:m.id)&&e.jsxs(e.Fragment,{children:[s.status==="active"?e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>C(s.id,"inactive"),children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Désactiver"]}):e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>C(s.id,"active"),children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Activer"]}),e.jsx(n,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(A,{to:`/users/${s.id}/edit`,children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Modifier"]})})]})]})]})})},s.id)):e.jsx(p,{children:e.jsxs(j,{className:"p-12 text-center",children:[e.jsx(o,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"Aucun utilisateur trouvé"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:t.search||t.role!=="all"||t.status!=="all"?"Aucun utilisateur ne correspond à vos critères de recherche.":"Aucun utilisateur n'est encore enregistré."}),u&&e.jsxs(n,{onClick:()=>f("/users/create"),children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Inviter des utilisateurs"]})]})})}),i.totalPages>1&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Affichage de ",(i.page-1)*i.limit+1," à"," ",Math.min(i.page*i.limit,i.total)," sur ",i.total," utilisateurs"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(n,{variant:"outline",size:"sm",onClick:()=>c(s=>({...s,page:s.page-1})),disabled:i.page===1,children:"Précédent"}),e.jsx(n,{variant:"outline",size:"sm",onClick:()=>c(s=>({...s,page:s.page+1})),disabled:i.page===i.totalPages,children:"Suivant"})]})]})]})};export{fe as default};
//# sourceMappingURL=UsersList-B842MtTQ.js.map
