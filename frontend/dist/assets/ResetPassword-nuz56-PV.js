import{w as R,y as Z,j as e,a as N,S as G,L as H}from"./index-gm4XY7Dh.js";import{r as t,g as W,d as J,L as b}from"./vendor-CvUQ7FSA.js";import{C as v,a as P,b as M,c as Q}from"./Card-ct0JxCCf.js";import{I as C}from"./Input-BoijLIkg.js";import{L as S}from"./label-B3NocW4B.js";import{A as u,a as w}from"./alert-dbwOQxjT.js";import{C as k}from"./circle-check-big-eEft8Q46.js";import{A}from"./arrow-left-yMfWrytx.js";import{C as V}from"./circle-alert-B-efKsjX.js";import{L as g}from"./lock-DiOu4SZ2.js";import{E}from"./eye-off-C98bhrRg.js";import{E as L}from"./eye-2sExp-ov.js";import{K as X}from"./key-DrLTbAfo.js";import"./firebase-De9GV7Vy.js";const he=()=>{const[r,q]=t.useState({password:"",confirmPassword:""}),[d,p]=t.useState(!1),[F,T]=t.useState(!1),[m,z]=t.useState(!1),[x,D]=t.useState(!1),[n,i]=t.useState({}),[o,I]=t.useState(0),[$]=W(),c=J(),{resetPassword:B,isAuthenticated:j}=R(),h=$.get("token");t.useEffect(()=>{j&&c("/dashboard",{replace:!0})},[j,c]),t.useEffect(()=>{h||(Z.error("Invalid or missing recovery token"),c("/forgot-password"))},[h,c]),t.useEffect(()=>{I((s=>{let l=0;return s.length>=6&&(l+=1),s.length>=8&&(l+=1),/[A-Z]/.test(s)&&(l+=1),/[0-9]/.test(s)&&(l+=1),/[^A-Za-z0-9]/.test(s)&&(l+=1),l})(r.password))},[r.password]);const U=()=>{const a={};return r.password?r.password.length<6&&(a.password="Password must be at least 6 characters"):a.password="Password is required",r.confirmPassword?r.password!==r.confirmPassword&&(a.confirmPassword="Passwords do not match"):a.confirmPassword="Please confirm your password",i(a),Object.keys(a).length===0},Y=async a=>{if(a.preventDefault(),!!U()){p(!0),i({});try{await B(h,r.password),T(!0),setTimeout(()=>{c("/login",{state:{message:"Password reset successfully! You can now sign in with your new password."}})},3e3)}catch(s){s.message.includes("Invalid token")?i({general:"This reset link is invalid or has expired. Please request a new one."}):s.message.includes("Token expired")?i({general:"This reset link has expired. Please request a new one."}):i({general:s.message||"Failed to reset password. Please try again."})}finally{p(!1)}}},y=a=>{const{name:s,value:l}=a.target;q(f=>({...f,[s]:l})),n[s]&&i(f=>({...f,[s]:""}))},K=()=>o<=1?"bg-red-500":o<=2?"bg-yellow-500":o<=3?"bg-blue-500":"bg-green-500",O=()=>o<=1?"Weak":o<=2?"Fair":o<=3?"Good":"Strong";return F?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-lg flex items-center justify-center",children:e.jsx(k,{className:"text-white w-6 h-6"})})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Password updated!"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Your password has been successfully reset"})]}),e.jsx(v,{className:"bg-white border-gray-200 shadow-sm",children:e.jsx(P,{className:"pt-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsxs(u,{children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx(w,{children:"You will be redirected to the sign in page in a few seconds."})]}),e.jsx("div",{className:"pt-4",children:e.jsx(N,{asChild:!0,className:"w-full bg-gray-900 text-white hover:bg-gray-800 font-medium",children:e.jsxs(b,{to:"/login",children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Continue to sign in"]})})})]})})})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"w-12 h-12 bg-gray-900 rounded-lg flex items-center justify-center",children:e.jsx(G,{className:"text-white w-6 h-6"})})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Set new password"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Choose a secure password for your account"})]}),e.jsxs(v,{className:"bg-white border-gray-200 shadow-sm",children:[e.jsx(M,{className:"space-y-1 pb-6",children:e.jsx(Q,{className:"text-xl text-center text-gray-900",children:"Create new password"})}),e.jsxs(P,{children:[n.general&&e.jsxs(u,{className:"mb-4",variant:"destructive",children:[e.jsx(V,{className:"h-4 w-4"}),e.jsx(w,{children:n.general})]}),e.jsxs("form",{onSubmit:Y,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"password",className:"text-sm font-medium text-gray-700 mb-2 block",children:"New password"}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 pointer-events-none z-10"}),e.jsx(C,{id:"password",name:"password",type:m?"text":"password",required:!0,value:r.password,onChange:y,className:`pl-10 pr-10 w-full ${n.password?"border-red-300 focus:border-red-500 focus:ring-red-500":""}`,placeholder:"At least 6 characters",minLength:6}),e.jsx("button",{type:"button",onClick:()=>z(!m),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 z-10",children:m?e.jsx(E,{className:"w-4 h-4"}):e.jsx(L,{className:"w-4 h-4"})})]}),r.password&&e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${K()}`,style:{width:`${o/5*100}%`}})}),e.jsx("span",{className:"text-xs text-gray-600",children:O()})]})}),n.password&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.password})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"confirmPassword",className:"text-sm font-medium text-gray-700 mb-2 block",children:"Confirm new password"}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 pointer-events-none z-10"}),e.jsx(C,{id:"confirmPassword",name:"confirmPassword",type:x?"text":"password",required:!0,value:r.confirmPassword,onChange:y,className:`pl-10 pr-10 w-full ${n.confirmPassword?"border-red-300 focus:border-red-500 focus:ring-red-500":""}`,placeholder:"Confirm your password"}),e.jsx("button",{type:"button",onClick:()=>D(!x),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 z-10",children:x?e.jsx(E,{className:"w-4 h-4"}):e.jsx(L,{className:"w-4 h-4"})})]}),n.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.confirmPassword})]})]}),e.jsxs(N,{type:"submit",disabled:d,className:"w-full bg-gray-900 text-white hover:bg-gray-800 font-medium",children:[d?e.jsx(H,{className:"w-4 h-4 animate-spin mr-2"}):e.jsx(X,{className:"w-4 h-4 mr-2"}),d?"Updating password...":"Update password"]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-200"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Need help?"})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs(b,{to:"/login",className:"text-gray-700 hover:text-gray-900 font-medium hover:underline inline-flex items-center",children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Back to sign in"]})})]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsxs(u,{children:[e.jsx(g,{className:"h-4 w-4"}),e.jsxs(w,{children:[e.jsx("strong",{children:"Security tip:"})," Use a unique password that you don't use for other accounts."]})]})})]})})};export{he as default};
//# sourceMappingURL=ResetPassword-nuz56-PV.js.map
