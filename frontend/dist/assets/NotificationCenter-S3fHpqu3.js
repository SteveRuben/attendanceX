import{c as k,w as X,z as J,A as u,y as r,j as e,F as f,B as v,a as d,n as K,o as Q,U as W,D as A}from"./index-gm4XY7Dh.js";import{r as h}from"./vendor-CvUQ7FSA.js";import{C as g,a as N}from"./Card-ct0JxCCf.js";import{I as Y}from"./Input-BoijLIkg.js";import{S as _,a as M,b as T,c as I,d as l}from"./select-byvKiojp.js";import{T as Z,a as ee,b as y,c as P}from"./tabs-unnrqVzs.js";import{C as q}from"./check-Cx9i6ejF.js";import{I as R}from"./info-b7pG8t1m.js";import{C as se}from"./circle-alert-B-efKsjX.js";import{C as z}from"./circle-check-big-eEft8Q46.js";import{C as ae}from"./circle-x-B_KOwtkV.js";import{S as te}from"./smartphone-P3L5Q6Fc.js";import{M as ne}from"./mail-Bm_S11fa.js";import"./firebase-De9GV7Vy.js";import"./index-TMJn6bF9.js";import"./chevron-down-L5bpcUyJ.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]],le=k("check-check",re);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],ce=k("message-square",ie);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],E=k("trash-2",oe),Ae=()=>{const{user:de}=X();J();const[x,m]=h.useState([]),[D,b]=h.useState(!0),[i,L]=h.useState({search:"",type:"all",channel:"all",unreadOnly:!1}),[n,j]=h.useState({page:1,limit:20,total:0,totalPages:0}),[c,C]=h.useState([]);h.useEffect(()=>{V()},[i,n.page]);const V=async()=>{try{b(!0);const s={page:n.page,limit:n.limit,unreadOnly:i.unreadOnly};i.type!=="all"&&(s.type=i.type),i.channel!=="all"&&(s.channel=i.channel);const a=await u.getMyNotifications(s);a.success&&a.data&&(m(a.data.data),j(t=>({...t,total:a.data.pagination.total,totalPages:a.data.pagination.totalPages})))}catch(s){console.error("Error loading notifications:",s),r.error("Erreur lors du chargement des notifications")}finally{b(!1)}},w=(s,a)=>{L(t=>({...t,[s]:a})),j(t=>({...t,page:1}))},B=s=>{const t={event_reminder:A,event_update:A,event_cancelled:ae,attendance_reminder:z,attendance_marked:z,user_invitation:W,system_alert:se,general:R}[s]||R;return e.jsx(t,{className:"w-4 h-4"})},O=s=>{const t={email:{variant:"default",label:"Email",icon:ne},sms:{variant:"secondary",label:"SMS",icon:ce},push:{variant:"outline",label:"Push",icon:te},in_app:{variant:"outline",label:"App",icon:f}}[s]||{variant:"outline",label:s,icon:f},o=t.icon;return e.jsxs(v,{variant:t.variant,className:"flex items-center gap-1",children:[e.jsx(o,{className:"w-3 h-3"}),t.label]})},F=s=>({event_reminder:"Rappel d'événement",event_update:"Mise à jour d'événement",event_cancelled:"Événement annulé",attendance_reminder:"Rappel de présence",attendance_marked:"Présence marquée",user_invitation:"Invitation utilisateur",system_alert:"Alerte système",general:"Général"})[s]||s,$=async s=>{try{await u.markAsRead(s),m(a=>a.map(t=>t.id===s?{...t,readAt:new Date().toISOString()}:t)),r.success("Notification marquée comme lue")}catch{r.error("Erreur lors de la mise à jour")}},H=async()=>{try{await u.markAllAsRead(),m(s=>s.map(a=>({...a,readAt:a.readAt||new Date().toISOString()}))),r.success("Toutes les notifications marquées comme lues")}catch{r.error("Erreur lors de la mise à jour")}},G=async s=>{try{await u.deleteNotification(s),m(a=>a.filter(t=>t.id!==s)),r.success("Notification supprimée")}catch{r.error("Erreur lors de la suppression")}},S=async s=>{if(c.length===0){r.warning("Aucune notification sélectionnée");return}try{s==="read"?(await Promise.all(c.map(a=>u.markAsRead(a))),m(a=>a.map(t=>c.includes(t.id)?{...t,readAt:new Date().toISOString()}:t)),r.success("Notifications marquées comme lues")):(await Promise.all(c.map(a=>u.deleteNotification(a))),m(a=>a.filter(t=>!c.includes(t.id))),r.success("Notifications supprimées")),C([])}catch{r.error("Erreur lors de l'action groupée")}},U=s=>{const a=new Date(s),o=(new Date().getTime()-a.getTime())/(1e3*60*60);return o<1?"Il y a quelques minutes":o<24?`Il y a ${Math.floor(o)} heure(s)`:o<48?"Hier":a.toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"})},p=x.filter(s=>!s.readAt).length;return D&&x.length===0?e.jsx("div",{className:"container-fluid py-6",children:e.jsxs("div",{className:"animate-pulse space-y-6",children:[e.jsx("div",{className:"h-8 bg-muted rounded w-1/3"}),e.jsx("div",{className:"grid gap-4",children:[...Array(5)].map((s,a)=>e.jsx("div",{className:"h-24 bg-muted rounded"},a))})]})}):e.jsxs("div",{className:"container-fluid py-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-foreground flex items-center",children:[e.jsx(f,{className:"w-8 h-8 mr-3"}),"Notifications",p>0&&e.jsxs(v,{variant:"destructive",className:"ml-3",children:[p," non lue",p>1?"s":""]})]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Gérez vos notifications et préférences"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[p>0&&e.jsxs(d,{variant:"outline",onClick:H,children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Tout marquer comme lu"]}),e.jsxs(d,{variant:"outline",children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Préférences"]})]})]}),e.jsxs(Z,{defaultValue:"all",className:"space-y-6",children:[e.jsxs(ee,{children:[e.jsxs(y,{value:"all",children:["Toutes (",x.length,")"]}),e.jsxs(y,{value:"unread",children:["Non lues (",p,")"]}),e.jsx(y,{value:"events",children:"Événements"}),e.jsx(y,{value:"attendance",children:"Présences"})]}),e.jsxs(P,{value:"all",className:"space-y-6",children:[e.jsx(g,{children:e.jsx(N,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(Y,{placeholder:"Rechercher dans les notifications...",value:i.search,onChange:s=>w("search",s.target.value),className:"pl-10"})]})}),e.jsxs(_,{value:i.type,onValueChange:s=>w("type",s),children:[e.jsx(M,{className:"w-[200px]",children:e.jsx(T,{placeholder:"Type"})}),e.jsxs(I,{children:[e.jsx(l,{value:"all",children:"Tous les types"}),e.jsx(l,{value:"event_reminder",children:"Rappel d'événement"}),e.jsx(l,{value:"event_update",children:"Mise à jour d'événement"}),e.jsx(l,{value:"attendance_reminder",children:"Rappel de présence"}),e.jsx(l,{value:"user_invitation",children:"Invitation"}),e.jsx(l,{value:"system_alert",children:"Alerte système"})]})]}),e.jsxs(_,{value:i.channel,onValueChange:s=>w("channel",s),children:[e.jsx(M,{className:"w-[150px]",children:e.jsx(T,{placeholder:"Canal"})}),e.jsxs(I,{children:[e.jsx(l,{value:"all",children:"Tous les canaux"}),e.jsx(l,{value:"email",children:"Email"}),e.jsx(l,{value:"sms",children:"SMS"}),e.jsx(l,{value:"push",children:"Push"}),e.jsx(l,{value:"in_app",children:"App"})]})]})]})})}),c.length>0&&e.jsx(g,{children:e.jsx(N,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[c.length," notification(s) sélectionnée(s)"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>S("read"),children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Marquer comme lues"]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>S("delete"),children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Supprimer"]})]})]})})}),e.jsx("div",{className:"space-y-4",children:x.length>0?x.map(s=>e.jsx(g,{className:`card-interactive ${s.readAt?"":"border-l-4 border-l-primary"}`,children:e.jsx(N,{className:"p-6",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("input",{type:"checkbox",checked:c.includes(s.id),onChange:a=>{a.target.checked?C(t=>[...t,s.id]):C(t=>t.filter(o=>o!==s.id))},className:"mt-1"}),e.jsx("div",{className:"flex-shrink-0 mt-1",children:B(s.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:`font-medium ${s.readAt?"":"font-semibold"}`,children:s.title}),!s.readAt&&e.jsx(v,{variant:"destructive",className:"text-xs",children:"Nouveau"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[O(s.channel),e.jsx("span",{className:"text-xs text-muted-foreground",children:U(s.createdAt)})]})]}),e.jsx("p",{className:"text-muted-foreground text-sm mb-3",children:s.message}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(v,{variant:"outline",className:"text-xs",children:F(s.type)}),e.jsxs("div",{className:"flex items-center space-x-2",children:[!s.readAt&&e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>$(s.id),children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Marquer comme lu"]}),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>G(s.id),children:e.jsx(E,{className:"w-4 h-4"})})]})]})]})]})})},s.id)):e.jsx(g,{children:e.jsxs(N,{className:"p-12 text-center",children:[e.jsx(f,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"Aucune notification"}),e.jsx("p",{className:"text-muted-foreground",children:"Vous n'avez pas encore reçu de notifications."})]})})}),n.totalPages>1&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Affichage de ",(n.page-1)*n.limit+1," à"," ",Math.min(n.page*n.limit,n.total)," sur ",n.total," notifications"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(d,{variant:"outline",size:"sm",onClick:()=>j(s=>({...s,page:s.page-1})),disabled:n.page===1,children:"Précédent"}),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>j(s=>({...s,page:s.page+1})),disabled:n.page===n.totalPages,children:"Suivant"})]})]})]}),e.jsx(P,{value:"unread",children:e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"Filtrage par notifications non lues..."})})})]})]})};export{Ae as default};
//# sourceMappingURL=NotificationCenter-S3fHpqu3.js.map
