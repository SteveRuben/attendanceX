import{w as R,z as V,y as m,j as e,a as i,E as N,o as $,B as y,D as b,U as q}from"./index-gm4XY7Dh.js";import{d as I,r as o,L as w}from"./vendor-CvUQ7FSA.js";import{C as u,a as h}from"./Card-ct0JxCCf.js";import{I as O}from"./Input-BoijLIkg.js";import{S as C,a as S,b as D,c as E,d as r}from"./select-byvKiojp.js";import{e as P}from"./eventService-DkagHfbT.js";import{M as U}from"./map-pin-Dg8dt4LF.js";import{C as W}from"./clock-Tx-U9-MC.js";import{E as G}from"./eye-2sExp-ov.js";import{S as _}from"./square-pen-Gln_tB11.js";import{C as H}from"./copy-ettdnWv-.js";import"./firebase-De9GV7Vy.js";import"./index-TMJn6bF9.js";import"./chevron-down-L5bpcUyJ.js";import"./check-Cx9i6ejF.js";const de=()=>{const{user:J}=R(),{canCreateEvents:x,canManageEvents:T}=V(),p=I(),[d,A]=o.useState([]),[k,j]=o.useState(!0),[t,g]=o.useState({search:"",status:"all",type:"all",sortBy:"startDate",sortOrder:"asc"}),[n,c]=o.useState({page:1,limit:20,total:0,totalPages:0});o.useEffect(()=>{f()},[t,n.page]);const f=async()=>{try{j(!0);const s={page:n.page,limit:n.limit,sortBy:t.sortBy,sortOrder:t.sortOrder};t.search&&(s.search=t.search),t.status!=="all"&&(s.status=t.status),t.type!=="all"&&(s.type=t.type);const a=await P.getEvents(s);a.success&&a.data&&(A(a.data.data),c(l=>({...l,total:a.data.pagination.total,totalPages:a.data.pagination.totalPages})))}catch(s){console.error("Error loading events:",s),m.error("Erreur lors du chargement des événements")}finally{j(!1)}},z=s=>{g(a=>({...a,search:s})),c(a=>({...a,page:1}))},v=(s,a)=>{g(l=>({...l,[s]:a})),c(l=>({...l,page:1}))},B=s=>{const l={draft:{variant:"secondary",label:"Brouillon"},published:{variant:"default",label:"Publié"},ongoing:{variant:"default",label:"En cours"},completed:{variant:"outline",label:"Terminé"},cancelled:{variant:"destructive",label:"Annulé"}}[s]||{variant:"outline",label:s};return e.jsx(y,{variant:l.variant,children:l.label})},L=s=>({meeting:"Réunion",training:"Formation",conference:"Conférence",workshop:"Atelier",seminar:"Séminaire",webinar:"Webinaire",other:"Autre"})[s]||s,M=s=>new Date(s).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),F=async s=>{try{(await P.duplicateEvent(s)).success&&(m.success("Événement dupliqué avec succès"),f())}catch{m.error("Erreur lors de la duplication")}};return k&&d.length===0?e.jsx("div",{className:"container-fluid py-6",children:e.jsxs("div",{className:"animate-pulse space-y-6",children:[e.jsx("div",{className:"h-8 bg-muted rounded w-1/3"}),e.jsx("div",{className:"grid gap-4",children:[...Array(5)].map((s,a)=>e.jsx("div",{className:"h-32 bg-muted rounded"},a))})]})}):e.jsxs("div",{className:"container-fluid py-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Événements"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Gérez vos événements et suivez les présences"})]}),x&&e.jsxs(i,{onClick:()=>p("/events/create"),children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Nouvel événement"]})]}),e.jsx(u,{children:e.jsx(h,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(O,{placeholder:"Rechercher des événements...",value:t.search,onChange:s=>z(s.target.value),className:"pl-10"})]})}),e.jsxs(C,{value:t.status,onValueChange:s=>v("status",s),children:[e.jsx(S,{className:"w-[180px]",children:e.jsx(D,{placeholder:"Statut"})}),e.jsxs(E,{children:[e.jsx(r,{value:"all",children:"Tous les statuts"}),e.jsx(r,{value:"draft",children:"Brouillon"}),e.jsx(r,{value:"published",children:"Publié"}),e.jsx(r,{value:"ongoing",children:"En cours"}),e.jsx(r,{value:"completed",children:"Terminé"}),e.jsx(r,{value:"cancelled",children:"Annulé"})]})]}),e.jsxs(C,{value:t.type,onValueChange:s=>v("type",s),children:[e.jsx(S,{className:"w-[180px]",children:e.jsx(D,{placeholder:"Type"})}),e.jsxs(E,{children:[e.jsx(r,{value:"all",children:"Tous les types"}),e.jsx(r,{value:"meeting",children:"Réunion"}),e.jsx(r,{value:"training",children:"Formation"}),e.jsx(r,{value:"conference",children:"Conférence"}),e.jsx(r,{value:"workshop",children:"Atelier"}),e.jsx(r,{value:"seminar",children:"Séminaire"}),e.jsx(r,{value:"webinar",children:"Webinaire"}),e.jsx(r,{value:"other",children:"Autre"})]})]})]})})}),e.jsx("div",{className:"space-y-4",children:d.length>0?d.map(s=>{var a;return e.jsx(u,{className:"card-interactive",children:e.jsx(h,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:s.title}),B(s.status),e.jsx(y,{variant:"outline",children:L(s.type)})]}),s.description&&e.jsx("p",{className:"text-muted-foreground mb-4 line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(b,{className:"w-4 h-4 mr-1"}),M(s.startDate)]}),s.location&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(U,{className:"w-4 h-4 mr-1"}),s.location.name]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(q,{className:"w-4 h-4 mr-1"}),((a=s.participants)==null?void 0:a.length)||0," participants"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(W,{className:"w-4 h-4 mr-1"}),new Date(s.endDate).getTime()-new Date(s.startDate).getTime()>864e5?`${Math.ceil((new Date(s.endDate).getTime()-new Date(s.startDate).getTime())/864e5)} jour(s)`:`${Math.ceil((new Date(s.endDate).getTime()-new Date(s.startDate).getTime())/36e5)} heure(s)`]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(i,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(w,{to:`/events/${s.id}`,children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Voir"]})}),T&&e.jsxs(e.Fragment,{children:[e.jsx(i,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(w,{to:`/events/${s.id}/edit`,children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Modifier"]})}),e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>F(s.id),children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Dupliquer"]})]})]})]})})},s.id)}):e.jsx(u,{children:e.jsxs(h,{className:"p-12 text-center",children:[e.jsx(b,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"Aucun événement trouvé"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:t.search||t.status!=="all"||t.type!=="all"?"Aucun événement ne correspond à vos critères de recherche.":"Vous n'avez pas encore créé d'événement."}),x&&e.jsxs(i,{onClick:()=>p("/events/create"),children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Créer votre premier événement"]})]})})}),n.totalPages>1&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Affichage de ",(n.page-1)*n.limit+1," à"," ",Math.min(n.page*n.limit,n.total)," sur ",n.total," événements"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(i,{variant:"outline",size:"sm",onClick:()=>c(s=>({...s,page:s.page-1})),disabled:n.page===1,children:"Précédent"}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>c(s=>({...s,page:s.page+1})),disabled:n.page===n.totalPages,children:"Suivant"})]})]})]})};export{de as default};
//# sourceMappingURL=EventsList-F7ociA6B.js.map
