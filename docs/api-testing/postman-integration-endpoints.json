{
  "name": "ðŸ”— Integrations",
  "description": "Third-party integrations and OAuth management endpoints",
  "item": [
    {
      "name": "Get User Integrations",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/user/integrations?provider=google&status=connected",
          "host": ["{{baseUrl}}"],
          "path": ["user", "integrations"],
          "query": [
            { "key": "provider", "value": "google" },
            { "key": "status", "value": "connected" }
          ]
        }
      }
    },
    {
      "name": "Connect Provider (OAuth)",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "if (pm.response.code === 200) {",
              "    const data = pm.response.json();",
              "    pm.globals.set('oauthState', data.data.state);",
              "    pm.test('OAuth URL generated', () => {",
              "        pm.expect(data.success).to.be.true;",
              "        pm.expect(data.data.authUrl).to.be.a('string');",
              "    });",
              "}"
            ]
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"scopes\": [\"calendar.readonly\", \"contacts.readonly\"],\n  \"redirectUri\": \"https://myapp.com/oauth/callback\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/user/integrations/{{provider}}/connect",
          "host": ["{{baseUrl}}"],
          "path": ["user", "integrations", "{{provider}}", "connect"]
        }
      }
    },
    {
      "name": "Complete OAuth Callback",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"code\": \"oauth_authorization_code_from_provider\",\n  \"state\": \"{{oauthState}}\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/user/integrations/{{provider}}/callback",
          "host": ["{{baseUrl}}"],
          "path": ["user", "integrations", "{{provider}}", "callback"]
        }
      }
    },
    {
      "name": "Update Integration Settings",
      "request": {
        "method": "PUT",
        "header": [
          { "key": "Content-Type", "value": "application/json" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"syncSettings\": {\n    \"enabled\": true,\n    \"syncCalendar\": true,\n    \"syncContacts\": false,\n    \"syncFrequency\": \"hourly\",\n    \"bidirectional\": true\n  }\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/user/integrations/{{integrationId}}/settings",
          "host": ["{{baseUrl}}"],
          "path": ["user", "integrations", "{{integrationId}}", "settings"]
        }
      }
    },
    {
      "name": "Get Integration History",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/user/integrations/{{integrationId}}/history?limit=20&offset=0&status=success",
          "host": ["{{baseUrl}}"],
          "path": ["user", "integrations", "{{integrationId}}", "history"],
          "query": [
            { "key": "limit", "value": "20" },
            { "key": "offset", "value": "0" },
            { "key": "status", "value": "success" }
          ]
        }
      }
    },
    {
      "name": "Trigger Manual Sync",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"syncType\": \"incremental\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/user/integrations/{{integrationId}}/sync",
          "host": ["{{baseUrl}}"],
          "path": ["user", "integrations", "{{integrationId}}", "sync"]
        }
      }
    },
    {
      "name": "Test Integration Connection",
      "request": {
        "method": "POST",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/user/integrations/{{integrationId}}/test",
          "host": ["{{baseUrl}}"],
          "path": ["user", "integrations", "{{integrationId}}", "test"]
        }
      }
    },
    {
      "name": "Disconnect Integration",
      "request": {
        "method": "DELETE",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/user/integrations/{{integrationId}}",
          "host": ["{{baseUrl}}"],
          "path": ["user", "integrations", "{{integrationId}}"]
        }
      }
    },
    {
      "name": "Get Analytics Metrics (Admin)",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/user/integrations/analytics/metrics",
          "host": ["{{baseUrl}}"],
          "path": ["user", "integrations", "analytics", "metrics"]
        }
      }
    }
  ]
}